<%= stylesheet_link_tag 'custom', media: 'all', 'data-turbolinks-track': 'reload' %>

<section class="mt-24 min-h-screen bg-cover" style="background-image: url('<%= asset_path('flower6.jpg') %>')">
  <div class="flex flex-col min-h-screen bg-black/60">
    <div class="container flex flex-col flex-1 px-6 py-12 mx-auto">
      <div class="flex-1 flex items-center justify-center flex-col text-white">
        <h1 class="text-2xl md:text-3xl lg:text-4xl xl:text-5xl 2xl:text-6xl text-center font-semibold">Post a beauty review</h1>
        <p class="max-w-xl mt-6 text-center">
          レビューを投稿する
        </p>
      </div>
      <div class="mt-8">
        <div class="w-full lg:w-[80%] px-8 py-10 mx-auto overflow-hidden bg-white shadow-2xl rounded-md">
          <h1 class="text-2xl font-medium text-gray-700 text-center">投稿フォーム</h1>
          <%# <p class="mt-2 text-gray-500 text-sm text-center">
            下記のフォームに沿って投稿してください。
          </p> %>
          <%= form_with(model: @post, local: true, html: { class: 'mt-10' }) do |form| %>
            <div class="flex-1">
              <label class="block mb-2 text-sm text-gray-600">投稿のカテゴリを選択してください*</label>
              <%# 投稿のプルダウン %>
              <%= form.select :post_category, options_for_select([
                ['選択', ''],
                ['経過', '経過'],
                ['アイテム', 'アイテム']
              ]), {}, class: 'block px-3 py-2 text-gray-600 bg-white border border-gray-200 rounded-md shadow-sm w-52 focus:outline-none focus:ring-primary-500 focus:border-primary-500' %>
            </div>

            <div class="flex-1 mt-6">
              <label class="block mb-2 text-sm text-gray-600">施術日を選択してください*</label>
              <%# 日付をカレンダー表示 %>
              <%= form.date_field :procedure_date, class: "block px-3 py-2 text-gray-600 bg-white border border-gray-200 rounded-md shadow-sm w-52 focus:outline-none focus:ring-primary-500 focus:border-primary-500" %>
            </div>

            <div class="flex-1 mt-6">
              <label class="block mb-2 text-sm text-gray-600">施術のカテゴリを選択してください*</label>
              <%= render partial: 'shared/post/area_pulldown' %>
            </div>

            <div class="flex-1 mt-6">
              <label class="block mb-2 text-sm text-gray-600">施術名を記入してください*</label>
              <%= form.text_field :title, placeholder: "二重埋没法", class: "block w-full px-5 py-3 mt-2 text-gray-700 bg-white border border-gray-200 rounded-md focus:border-blue-400 focus:ring-blue-300 focus:ring-opacity-40 focus:outline-none focus:ring" %>
            </div>

            <div class="flex-1 mt-6">
              <label class="block mb-2 text-sm text-gray-600">満足度を選択してください*</label>
              <div id="stars_<%= @post.id %>" class="stars-container"></div>
              <%= form.hidden_field :satisfaction_rating, id: 'satisfaction_rating' %>
            </div>

            <div class="w-full mt-6">
              <label class="block mb-2 text-sm text-gray-600">内容</label>
              <%= form.text_area :body, class: "block w-full h-32 px-5 py-3 mt-2 text-gray-700 placeholder-gray-400 bg-white border border-gray-200 rounded-md md:h-48 focus:border-blue-400 focus:ring-blue-300 focus:ring-opacity-40 focus:outline-none focus:ring", placeholder: "ダウンタイム１日目です。昨日より腫れが強くなってきました。今日は目元を冷やして安静にします。" %>
            </div>

            <%# 画像アップロードボタン %>
            <div class="form-group w-full mt-6">
              <label class="block mb-2 text-sm text-gray-600">画像を投稿する</label>
              <%= form.file_field :procedure_image, class: "block w-full text-sm text-slate-500 border border-gray-200 rounded-lg file:mr-4 file:py-2 file:px-4 file:rounded-sm file:border-0 file:text-sm file:font-semibold file:bg-gray-100 file:text-gray-500 hover:file:bg-gray-200 js-file-select-preview", accept: 'image/*', data: { target: '#preview-target' } %>
              <%= form.hidden_field :post_image_cache %>
            </div>

            <div class="form-group mt-3 mb-3">
                <% if @post.procedure_image.present? %>
                  <%= image_tag @post.procedure_image, class: 'w-[300px] h-[250px] object-cover' %>
                <% else %>
                  <%= image_tag 'post_default1.png', id: 'preview-target', class: 'w-[300px] h-[250px] object-cover' %>
                <% end %>
            </div>
            
            <span class="text-sm text-gray-500">*必須</span>
            <%= form.submit "投稿する", class: "btn-custom w-full px-6 py-3 mt-12 text-sm font-medium tracking-wide text-white rounded-sm" %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</section>



<%# 星のレーティング %>
<script>
  $(document).ready(function() {
    $('#stars_<%= @post.id %>').raty({
      path: '/assets',
      scoreName: 'post[satisfaction_rating]',
      score: 1,
      click: function(score, evt) {
        $('#satisfaction_rating').val(score);
      }
    });
  });
</script>